@@ -16,7 +16,7 @@
     use constants_mod, only : i_def, r_def
     use quadrature_rule_gaussian_mod, only : quadrature_rule_gaussian_type
     use setop_random_kernel_mod, only : setop_random_kernel_type
-    use log_mod, only : log_event, log_level_error, log_level_info, log_scratch_space
+    use log_mod, only : log_event, log_level_error, log_level_info, log_scratch_space, log_level_debug
     real(kind=r_def), parameter :: overall_tolerance = 1500.0_r_def
     type(mesh_type), pointer, intent(in) :: mesh
     type(field_type), dimension(3), intent(in), optional :: chi
@@ -31,12 +31,15 @@
     type(field_type) :: u_w2_input
     real(kind=r_def) :: v_w1_inner_prod
     real(kind=r_def) :: u_w2_inner_prod
+    real(kind=r_def) :: v_w1_sf
+    real(kind=r_def) :: u_w2_sf
     real(kind=r_def) :: inner1
     real(kind=r_def) :: v_w1_v_w1_input_inner_prod
     real(kind=r_def) :: u_w2_u_w2_input_inner_prod
     real(kind=r_def) :: inner2
     real(kind=r_def) :: MachineTol
     real(kind=r_def) :: relative_diff
+    real(kind=r_def), parameter :: eps = 1.0e-30_r_def
 
     vector_space_w1_ptr => function_space_collection%get_fs(mesh,element_order_h,element_order_v,w1)
     vector_space_w2_ptr => function_space_collection%get_fs(mesh,element_order_h,element_order_v,w2)
@@ -51,9 +54,19 @@
     call invoke(setval_random(v_w1), setval_x(v_w1_input, v_w1), setval_random(u_w2), setval_x(u_w2_input, u_w2), &
 &w2_to_w1_projection_kernel_type(v_w1, u_w2, qr_xyoz), x_innerproduct_x(v_w1_inner_prod, v_w1), x_innerproduct_x(u_w2_inner_prod, &
 &u_w2))
+    write( log_scratch_space, * ) "adjt_w2_to_w1_projection_alg inner products:"
+    call log_event( log_scratch_space, log_level_debug )
+    write( log_scratch_space, * ) "u_w2 inner product = ", u_w2_inner_prod
+    call log_event( log_scratch_space, log_level_debug )
+    write( log_scratch_space, * ) "v_w1 inner product = ", v_w1_inner_prod
+    call log_event( log_scratch_space, log_level_debug )
+    u_w2_sf = 1.0_r_def / (u_w2_inner_prod + eps)
+    v_w1_sf = 1.0_r_def / (v_w1_inner_prod + eps)
     inner1 = 0.0_r_def
-    inner1 = inner1 + v_w1_inner_prod
-    inner1 = inner1 + u_w2_inner_prod
+    inner1 = inner1 + u_w2_inner_prod * u_w2_sf
+    inner1 = inner1 + v_w1_inner_prod * v_w1_sf
+    call invoke( inc_a_times_X( u_w2_sf, u_w2 ), &
+                 inc_a_times_X( v_w1_sf, v_w1 ) )
     v_w1_v_w1_input_inner_prod = 0.0_r_def
     u_w2_u_w2_input_inner_prod = 0.0_r_def
     call invoke(adj_w2_to_w1_projection_kernel_type(v_w1, u_w2, qr_xyoz), x_innerproduct_y(v_w1_v_w1_input_inner_prod, v_w1, &
