@@ -9,7 +9,7 @@
 !! This version differs from "convert_hdiv_field" in that the target field
 !! must be horizontally discontinuous, i.e. w3 or wtheta
 
-module sci_dg_convert_hdiv_field_kernel_mod
+module dg_convert_hdiv_field_kernel_mod
 
 use kernel_mod,              only : kernel_type
 use argument_mod,            only : arg_type, func_type,         &
@@ -160,7 +160,8 @@
         vector_in(:) = vector_in(:) + computational_field(map2(df2)+k)*basis2(:,df2,df)
       end do
 
-      vector_out(:) = matmul(jacobian,vector_in)/dj
+      vector_out(:) = matmul(jacobian,vector_in)
+      vector_out = vector_out/dj
 
       physical_field1(map1(df)+k) = physical_field1(map1(df)+k) + vector_out(1)
       physical_field2(map1(df)+k) = physical_field2(map1(df)+k) + vector_out(2)
@@ -170,4 +171,4 @@
 
 end subroutine dg_convert_hdiv_field_code
 
-end module sci_dg_convert_hdiv_field_kernel_mod
+end module dg_convert_hdiv_field_kernel_mod
